#!/usr/bin/python
#
# Produce example JSON to be POSTed to API backend
#
# $ ./example-json | curl --data-urlencode request@- -v localhost:8511/mfa_add
#
#
# Test key generated with
# >>> from Crypto.PublicKey import RSA
# >>> key = RSA.generate(1024)
# >>> print key.publickey().exportKey('PEM')
# >>> print key.exportKey('PEM')

import sys
import json
import jose
import time

JWK = {'k': 'password',
       }

a = {'twofa_add':
         {
        'data': {
            "sn": "Thulin",
            "givenName": "Fredrik",
            },
        },
     'version': 1,
     }

sys.stderr.write(json.dumps(a, sort_keys=True, indent=4) + '\n')

jwe = jose.encrypt({'foo': 'bar'}, JWK)

print ""
print jose.serialize_compact(jwe)
